# é¡¹ç›®æ¦‚è§ˆ - å¾®ä¿¡è®¢é˜…å·è®¤è¯ç³»ç»Ÿ

## ğŸ¯ è®¾è®¡ç†å¿µ

è¿™æ˜¯ä¸€ä¸ª**æç®€ä¸»ä¹‰**çš„å¾®ä¿¡è®¢é˜…å·è®¤è¯ç³»ç»Ÿï¼Œæ ¸å¿ƒç†å¿µæ˜¯ï¼š

1. **é›¶é…ç½®æ•°æ®åº“** - ä½¿ç”¨å†…å­˜å­˜å‚¨ï¼Œå¼€ç®±å³ç”¨
2. **ç”¨æˆ·ä¸»åŠ¨éªŒè¯** - æ— éœ€è½®è¯¢ï¼Œç”¨æˆ·ç‚¹å‡»æŒ‰é’®è§¦å‘éªŒè¯
3. **Nuxt 4 æœ€ä½³å®è·µ** - ç°ä»£åŒ–ã€ç±»å‹å®‰å…¨
4. **ä»£ç å³æ–‡æ¡£** - æ¸…æ™°çš„ç»“æ„å’Œæ³¨é‡Š

## ğŸ“Š æ–°ç‰ˆæµç¨‹å¯¹æ¯”

| ç»´åº¦ | æ—§ç‰ˆ (è‡ªåŠ¨è½®è¯¢) | æ–°ç‰ˆ (ä¸»åŠ¨éªŒè¯) | æ”¹è¿› |
|------|----------------|----------------|------|
| **æµç¨‹** | è®¿é—®â†’è½®è¯¢â†’è‡ªåŠ¨ç™»å½• | è®¿é—®â†’æ˜¾ç¤ºç â†’å‘é€â†’ç‚¹å‡»éªŒè¯ | âœ… æ›´ç›´è§‚ |
| **ç”¨æˆ·ä½“éªŒ** | éœ€è¦ç­‰å¾… | ä¸»åŠ¨æ§åˆ¶ | âœ… æ›´å¥½ |
| **æœåŠ¡å™¨å‹åŠ›** | æ¯3ç§’è½®è¯¢ | åªåœ¨ç‚¹å‡»æ—¶æ£€æŸ¥ | âœ… æ›´ä½ |
| **ä»£ç å¤æ‚åº¦** | éœ€è¦auth.vue | å•é¡µå®Œæˆ | âœ… æ›´ç®€å• |
| **é¡µé¢æ•°é‡** | 2é¡µ | 1é¡µ | âœ… æ›´ç®€æ´ |

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç”¨æˆ·è®¿é—®ç½‘ç«™                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  1. æ£€æŸ¥ Session/Cookie                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Session API â”‚  â”‚  Cookie      â”‚  â”‚  Auth API    â”‚      â”‚
â”‚  â”‚  /api/auth/  â”‚  â”‚  wxauth-     â”‚  â”‚  /api/auth/  â”‚      â”‚
â”‚  â”‚  session     â”‚  â”‚  openid      â”‚  â”‚  check       â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
                    â”‚             â”‚
                   å·²è®¤è¯        æœªè®¤è¯
                    â”‚             â”‚
                    â–¼             â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  æ˜¾ç¤ºå†…å®¹   â”‚  â”‚  ç”Ÿæˆè®¤è¯ç    â”‚
            â”‚  (index)   â”‚  â”‚  + Token     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  æ˜¾ç¤º6ä½è®¤è¯ç    â”‚
                            â”‚  æ˜¾ç¤ºæ“ä½œæŒ‡å¼•    â”‚
                            â”‚  ç­‰å¾…ç”¨æˆ·æ“ä½œ    â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å¾®ä¿¡å…¬ä¼—å·äº¤äº’                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  ç”¨æˆ·å…³æ³¨    â”‚ â†’ â”‚  å‘é€è®¤è¯ç   â”‚ â†’ â”‚  å…¬ä¼—å·éªŒè¯  â”‚      â”‚
â”‚  â”‚  subscribe   â”‚  â”‚  6ä½æ•°å­—     â”‚  â”‚  å›å¤æˆåŠŸ    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ç”¨æˆ·ç‚¹å‡»"æˆ‘å·²å…³æ³¨"æŒ‰é’®                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  æ£€æŸ¥API     â”‚ â†’ â”‚  è®¾ç½®Session â”‚ â†’ â”‚  å®Œæˆç™»å½•    â”‚      â”‚
â”‚  â”‚  /api/auth/  â”‚  â”‚  /api/auth/  â”‚  â”‚  è·³è½¬é¦–é¡µ    â”‚      â”‚
â”‚  â”‚  check       â”‚  â”‚  session     â”‚  â”‚              â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  è®¤è¯æˆåŠŸ   â”‚
                    â”‚  è®¿é—®å†…å®¹   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

#### 1. å†…å­˜å­˜å‚¨ (`server/utils/storage.ts`)
```typescript
// ä½¿ç”¨ Map å®ç°ï¼Œæ— éœ€æ•°æ®åº“
const pendingCodes = new Map();      // å¾…éªŒè¯ä»£ç 
const authCodes = new Map();         // è®¤è¯ç 
const authenticatedUsers = new Map(); // å·²è®¤è¯ç”¨æˆ·

// è‡ªåŠ¨æ¸…ç†ï¼ˆæ¯åˆ†é’Ÿï¼‰
setInterval(() => { /* æ¸…ç†è¿‡æœŸæ•°æ® */ }, 60 * 1000);
```

**ä¼˜åŠ¿ï¼š**
- âœ… é›¶é…ç½®
- âœ… é«˜æ€§èƒ½ï¼ˆO(1) æŸ¥è¯¢ï¼‰
- âœ… è‡ªåŠ¨æ¸…ç†

**å±€é™ï¼š**
- âŒ é‡å¯ä¸¢å¤±
- âŒ å•å®ä¾‹

#### 2. å‰ç«¯è®¤è¯é¡µ (`pages/index.vue`)
```typescript
// é¡µé¢åŠ è½½æ—¶ç”Ÿæˆè®¤è¯ç 
onMounted(async () => {
  // 1. æ£€æŸ¥ session
  // 2. æ£€æŸ¥ cookie ä¸­çš„ openid
  // 3. æ£€æŸ¥æ˜¯å¦æœ‰å¾…éªŒè¯çš„ token
  // 4. ç”Ÿæˆæ–°çš„è®¤è¯ç å’Œ token
  // 5. ä¿å­˜åˆ°åç«¯å’Œ cookie
});

// ç”¨æˆ·ç‚¹å‡»éªŒè¯
const verifyAuth = async () => {
  // 1. é€šè¿‡ token æ£€æŸ¥è®¤è¯çŠ¶æ€
  // 2. å¦‚æœå…¬ä¼—å·å·²å¤„ç†ï¼Œå®Œæˆç™»å½•
  // 3. å¦‚æœæœªå¤„ç†ï¼Œæç¤ºç”¨æˆ·å‘é€è®¤è¯ç 
};
```

#### 3. å¾®ä¿¡æ¶ˆæ¯å¤„ç†å™¨ (`server/api/wechat/message.ts`)
```typescript
// æ”¯æŒå‘é€6ä½æ•°å­—è®¤è¯ç 
if (/^\d{6}$/.test(content)) {
  const token = findTokenByPendingCode(content);
  if (token) {
    convertPendingToAuthCode(token, openid);
    return reply("âœ… è®¤è¯æˆåŠŸï¼");
  }
}

// å…¼å®¹æ—§ç‰ˆå…³é”®è¯
if (containsAuthKeyword(content)) {
  const code = generateVerificationCode();
  saveAuthCode(code, openid);
  return reply(`æ‚¨çš„è®¤è¯ç ï¼š${code}`);
}
```

#### 4. è®¤è¯æ£€æŸ¥ API (`server/api/auth/check.ts`)
```typescript
// æ”¯æŒå¤šç§éªŒè¯æ–¹å¼
export default defineEventHandler(async (event) => {
  const { token, openid, authToken } = getQuery(event);

  // 1. é€šè¿‡ token æ£€æŸ¥ï¼ˆæ–°æµç¨‹ï¼‰
  if (token) {
    const pending = getPendingCode(token);
    if (pending) {
      const auth = getUserByAuthCode(pending.code);
      if (auth) {
        // è®¤è¯æˆåŠŸ
        markUserAuthenticated(auth.openid, auth);
        return { authenticated: true, user: auth };
      }
      // ç­‰å¾…ä¸­
      return { authenticated: false, pendingCode: pending.code };
    }
  }

  // 2. é€šè¿‡ openid æ£€æŸ¥ï¼ˆå·²ç™»å½•ï¼‰
  if (openid) {
    const user = getAuthenticatedUser(openid);
    if (user) return { authenticated: true, user };
  }

  // 3. é€šè¿‡è®¤è¯ç æ£€æŸ¥ï¼ˆå…¼å®¹æ—§ç‰ˆï¼‰
  if (authToken) {
    // ...
  }

  return { authenticated: false };
});
```

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### Session ç®¡ç†

ä½¿ç”¨ **AES-256-GCM** åŠ å¯† Cookieï¼š

```typescript
// åŠ å¯†
const cipher = crypto.createCipheriv('aes-256-gcm', key, iv);
const encrypted = cipher.update(data, 'utf8', 'hex');

// è§£å¯†
const decipher = crypto.createDecipheriv('aes-256-gcm', key, iv);
const decrypted = decipher.update(encrypted, 'hex', 'utf8');
```

**å®‰å…¨ç‰¹æ€§ï¼š**
- âœ… åŠ å¯†å­˜å‚¨
- âœ… è®¤è¯æ ‡ç­¾ (Auth Tag)
- âœ… éšæœº IV
- âœ… HttpOnly Cookie

### XML å¤„ç†

ä½¿ç”¨ `fast-xml-parser` å¤„ç†å¾®ä¿¡æ¶ˆæ¯ï¼š

```typescript
// è§£æ
const parser = new XMLParser({ ignoreAttributes: false });
const message = parser.parse(xml);

// ç”Ÿæˆ
const builder = new XMLBuilder({ ignoreAttributes: false });
const xml = builder.build(xmlObj);
```

### å‰ç«¯çŠ¶æ€ç®¡ç†

ä½¿ç”¨ Vue 3 Composition APIï¼š

```typescript
const verificationCode = ref<string | null>(null);
const pendingToken = ref<string | null>(null);
const message = ref<{ type: string; text: string } | null>(null);

// ç”Ÿæˆ6ä½éšæœºç 
function generateCode(): string {
  return Math.floor(100000 + Math.random() * 900000).toString();
}

// ä¿å­˜tokenåˆ°cookie
function saveToken(token: string) {
  document.cookie = `wxauth-token=${token}; max-age=300; path=/; sameSite=lax`;
}
```

## ğŸ“ æ–‡ä»¶ç»“æ„è¯¦è§£

```
wechat-subscription-auth/
â”‚
â”œâ”€â”€ server/                    # æœåŠ¡ç«¯ï¼ˆNuxt Serverï¼‰
â”‚   â”œâ”€â”€ api/                   # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ wechat/
â”‚   â”‚   â”‚   â””â”€â”€ message.ts    # å¾®ä¿¡æ¶ˆæ¯å…¥å£ï¼ˆæ¥æ”¶è®¤è¯ç ï¼‰
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”‚   â”œâ”€â”€ setup.ts      # ç”Ÿæˆè®¤è¯ç ï¼ˆæ–°ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ check.ts      # è®¤è¯æ£€æŸ¥ï¼ˆæ›´æ–°ï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ session.ts    # Session ç®¡ç†
â”‚   â”‚   â””â”€â”€ admin/            # (é¢„ç•™) ç®¡ç†åå°
â”‚   â”œâ”€â”€ utils/                 # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ storage.ts        # å†…å­˜å­˜å‚¨æ ¸å¿ƒï¼ˆæ–°å¢pendingï¼‰
â”‚   â”‚   â”œâ”€â”€ wechat.ts         # å¾®ä¿¡å·¥å…·
â”‚   â”‚   â””â”€â”€ session.ts        # Session å·¥å…·
â”‚   â””â”€â”€ plugins/               # Nitro æ’ä»¶
â”‚
â”œâ”€â”€ pages/                     # å‰ç«¯é¡µé¢ï¼ˆè‡ªåŠ¨è·¯ç”±ï¼‰
â”‚   â””â”€â”€ index.vue              # å•é¡µè®¤è¯ï¼ˆæ›´æ–°ï¼‰
â”‚
â”œâ”€â”€ app.vue                    # æ ¹ç»„ä»¶
â”œâ”€â”€ nuxt.config.ts             # Nuxt é…ç½®
â”œâ”€â”€ tailwind.config.ts         # Tailwind é…ç½®
â”œâ”€â”€ tsconfig.json              # TypeScript é…ç½®
â”‚
â”œâ”€â”€ package.json               # ä¾èµ–
â”œâ”€â”€ .env.example               # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ .gitignore                 # Git å¿½ç•¥
â”‚
â”œâ”€â”€ README.md                  # å®Œæ•´æ–‡æ¡£ï¼ˆæ›´æ–°ï¼‰
â””â”€â”€ PROJECT_OVERVIEW.md        # æœ¬æ–‡æ¡£
```

## ğŸ¨ UI è®¾è®¡æ€è·¯

### é¢œè‰²æ–¹æ¡ˆ

- **ä¸»è‰²è°ƒ**ï¼šè“ç´«æ¸å˜ï¼ˆ`from-blue-500 to-purple-600`ï¼‰
- **è®¤è¯ç **ï¼šè“è‰²é«˜äº®ï¼ˆ`text-blue-600`ï¼‰
- **æˆåŠŸè‰²**ï¼šç»¿è‰²ï¼ˆ`green-500`ï¼‰
- **è­¦å‘Šè‰²**ï¼šé»„è‰²ï¼ˆ`yellow-500`ï¼‰
- **é”™è¯¯è‰²**ï¼šçº¢è‰²ï¼ˆ`red-500`ï¼‰

### äº¤äº’è®¾è®¡

1. **å³æ—¶åé¦ˆ** - é¡µé¢åŠ è½½ç«‹å³ç”Ÿæˆè®¤è¯ç 
2. **æ¸…æ™°å±•ç¤º** - 6ä½æ•°å­—å¤§å·æ˜¾ç¤º
3. **æ­¥éª¤æŒ‡å¼•** - 1-2-3 æ­¥éª¤æ¸…æ™°
4. **ä¸»åŠ¨éªŒè¯** - ç”¨æˆ·ç‚¹å‡»æŒ‰é’®è§¦å‘
5. **çŠ¶æ€æç¤º** - å®æ—¶æ˜¾ç¤ºéªŒè¯çŠ¶æ€

## ğŸš€ éƒ¨ç½²ç­–ç•¥

### å¼€å‘ç¯å¢ƒ

```bash
pnpm dev
```

### ç”Ÿäº§ç¯å¢ƒ

#### æ–¹æ¡ˆ 1: Vercelï¼ˆæ¨èï¼‰
- âœ… å…è´¹
- âœ… è‡ªåŠ¨éƒ¨ç½²
- âœ… å…¨çƒ CDN

#### æ–¹æ¡ˆ 2: Docker
```bash
docker-compose up -d
```

#### æ–¹æ¡ˆ 3: è‡ªå»ºæœåŠ¡å™¨
```bash
pnpm build
pnpm preview
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### 1. å†…å­˜ä¼˜åŒ–
- è‡ªåŠ¨æ¸…ç†è¿‡æœŸæ•°æ®
- Map ç»“æ„é«˜æ•ˆæŸ¥è¯¢
- å®šæ—¶ä»»åŠ¡æ¸…ç†

### 2. ç½‘ç»œä¼˜åŒ–
- å‡å°‘ API è°ƒç”¨
- ç”¨æˆ·ä¸»åŠ¨è§¦å‘éªŒè¯
- å¤±è´¥é‡è¯•æœºåˆ¶

### 3. å‰ç«¯ä¼˜åŒ–
- åº”ç”¨çº§çŠ¶æ€ç®¡ç†
- æ¡ä»¶æ¸²æŸ“
- äº‹ä»¶æ¸…ç†

## ğŸ”’ å®‰å…¨è€ƒè™‘

### å·²å®ç°
- âœ… ç­¾åéªŒè¯ï¼ˆå¾®ä¿¡æ¶ˆæ¯ï¼‰
- âœ… Session åŠ å¯†
- âœ… Cookie å®‰å…¨è®¾ç½®
- âœ… è¾“å…¥éªŒè¯
- âœ… 6ä½æ•°å­—éªŒè¯

### å»ºè®®æ‰©å±•
- âš ï¸ æ·»åŠ é€Ÿç‡é™åˆ¶
- âš ï¸ æ—¥å¿—å®¡è®¡
- âš ï¸ IP ç™½åå•

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### é€‚åˆ
- âœ… ä¸ªäººé¡¹ç›®
- âœ… å°å‹åº”ç”¨
- âœ… å¼€å‘/æµ‹è¯•
- âœ… å¿«é€ŸåŸå‹
- âœ… è®¢é˜…å·è®¤è¯

### ä¸é€‚åˆï¼ˆéœ€æ‰©å±•ï¼‰
- âŒ å¤§è§„æ¨¡ç”Ÿäº§
- âŒ å¤šæœåŠ¡å™¨éƒ¨ç½²
- âŒ éœ€è¦æ•°æ®æŒä¹…åŒ–

## ğŸ”® æœªæ¥æ‰©å±•

### å¯é€‰åŠŸèƒ½
1. **æ•°æ®åº“æ”¯æŒ** - æ·»åŠ  Prisma + PostgreSQL
2. **WebSocket** - å®æ—¶é€šçŸ¥
3. **ç®¡ç†åå°** - æŸ¥çœ‹è®¤è¯è®°å½•
4. **å¤šå…¬ä¼—å·** - æ”¯æŒå¤šä¸ªè®¢é˜…å·
5. **çŸ­ä¿¡éªŒè¯** - åŒé‡éªŒè¯

### æ‰©å±•æ–¹å¼
```typescript
// åªéœ€æ›¿æ¢ storage.ts
export async function savePendingCode(token, code) {
  // æ”¹ä¸ºæ•°æ®åº“æˆ– Redis
  await redis.setex(`pending:${token}`, 300, { code });
}
```

## ğŸ“š å­¦ä¹ ä»·å€¼

### Nuxt 4 ç‰¹æ€§
- âœ… æœåŠ¡ç«¯ API è·¯ç”±
- âœ… è¿è¡Œæ—¶é…ç½®
- âœ… è‡ªåŠ¨è·¯ç”±
- âœ… TypeScript é›†æˆ

### å®‰å…¨å®è·µ
- âœ… åŠ å¯† Cookie
- âœ… ç­¾åéªŒè¯
- âœ… è¾“å…¥æ¸…ç†

### å‰ç«¯æœ€ä½³å®è·µ
- âœ… Composition API
- âœ… çŠ¶æ€ç®¡ç†
- âœ… äº‹ä»¶å¤„ç†

## ğŸ‰ æ€»ç»“

è¿™ä¸ªé¡¹ç›®å±•ç¤ºäº†å¦‚ä½•ç”¨**æœ€å°‘çš„ä»£ç **å®ç°ä¸€ä¸ª**å®Œæ•´å¯ç”¨**çš„å¾®ä¿¡è®¤è¯ç³»ç»Ÿï¼š

- **ä»£ç é‡**ï¼š~600 è¡Œ
- **ä¾èµ–**ï¼š5 ä¸ªæ ¸å¿ƒåŒ…
- **éƒ¨ç½²æ—¶é—´**ï¼š5 åˆ†é’Ÿ
- **ç»´æŠ¤æˆæœ¬**ï¼šæä½

**æ ¸å¿ƒæ€æƒ³**ï¼šç®€å•å³æ˜¯ç¾ï¼Œå¤Ÿç”¨å°±å¥½ã€‚ç”¨æˆ·ä¸»åŠ¨éªŒè¯æ¯”è‡ªåŠ¨è½®è¯¢æ›´ç›´è§‚ã€æ›´çœèµ„æºã€‚

---

**å¼€å§‹ä½¿ç”¨ï¼š**

```bash
pnpm install
cp .env.example .env
pnpm dev
```

ç¥ä½ ç¼–ç æ„‰å¿«ï¼ğŸš€
